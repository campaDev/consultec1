---
import SEOHead from '../components/seo/SEOHead.astro';
import '../styles/global.css'; // Importante: Aquí cargamos Tailwind + OKLCH

import { ClientRouter } from "astro:transitions";

interface Props {
  title?: string;
  description?: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="es" class="scroll-smooth">
  <head>
    <SEOHead title={title} description={description} />
    <ClientRouter />
    <script is:inline>
      // Verifica preferencia guardada o preferencia del sistema
      const theme = (() => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
          return localStorage.getItem('theme');
        }
        if (window.matchMedia('(prefers-color-scheme: light)').matches) {
          return 'light';
        }
        return 'dark'; // Default
      })();
      // Aplica el atributo al HTML raíz inmediatamente
      if (theme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      } else {
        document.documentElement.setAttribute('data-theme', 'dark');
      }
      // Maneja View Transitions de Astro (si navegas entre páginas)
      document.addEventListener('astro:after-swap', () => {
        const storedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
        document.documentElement.setAttribute('data-theme', storedTheme);
      });
    </script>
  </head>
  
  <body class="bg-space-950 text-text-main font-body antialiased mesh-background selection:bg-neon-cyan selection:text-space-950 overflow-x-hidden">
    
    <div class="fixed inset-0 pointer-events-none opacity-[0.02] mix-blend-overlay z-0" 
         style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noiseFilter%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.65%22 numOctaves=%223%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noiseFilter)%22 opacity=%221%22/%3E%3C/svg%3E')">
    </div>

    <div class="relative z-10 flex flex-col min-h-screen">
      <slot />
    </div>

  </body>
</html>
